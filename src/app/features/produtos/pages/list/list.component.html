<div class="d-flex min-vh-100 bg-light">
  <!-- Sidebar -->
  <aside class="bg-secondary d-flex flex-column p-3" style="width: 250px; border-radius: 0 1rem 1rem 0;">
    <!-- Implementaremos o menu depois -->
  </aside>

  <main class="flex-grow-1 p-4">
    <!-- Cabe√ßalho -->
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h1 class="h4 fw-bold">Sistema de Estoque</h1>
      <button mdbBtn color="dark" rounded="true" (click)="mostrarForm = !mostrarForm">
        Adicionar novo item
      </button>
    </div>

      <!-- Formul√°rio de cria√ß√£o -->
      <!-- Formul√°rio de cria√ß√£o -->
<div *ngIf="mostrarForm" class="card p-3 mb-4 shadow-sm rounded-4">
  <h5 class="mb-3">Novo Produto</h5>
  <form (ngSubmit)="criarProduto()">
    <div class="row g-2">
      <div class="col-md-4">
        <input 
          type="text" 
          class="form-control" 
          placeholder="Nome do Produto" 
          [(ngModel)]="novoProduto.nome" 
          name="nome" 
          required 
        />
      </div>
      <div class="col-md-2">
        <input 
          type="number" 
          class="form-control" 
          placeholder="Quantidade" 
          [(ngModel)]="novoProduto.quantidade" 
          name="quantidade" 
          required 
        />
      </div>
      <div class="col-md-2">
        <input 
          type="number" 
          step="0.01" 
          class="form-control" 
          placeholder="Pre√ßo (R$)" 
          [(ngModel)]="novoProduto.preco" 
          name="preco" 
          required 
        />
      </div>
      <div class="col-md-3">
        <input 
          type="number" 
          class="form-control" 
          placeholder="ID da Categoria" 
          [(ngModel)]="novoProduto.categoria.id" 
          name="categoriaId" 
          required 
        />
      </div>
      <div class="col-md-1 d-flex gap-2">
        <button mdbBtn color="success" type="submit">‚úî</button>
        <button mdbBtn color="secondary" type="button" (click)="mostrarForm = false">‚úñ</button>
      </div>
    </div>
  </form>
</div>


    <!-- Barra de busca e filtros -->
    <div class="d-flex gap-2 mb-3 flex-wrap">
      <div class="form-outline flex-grow-1">
        <input type="text" id="searchInput" class="form-control" placeholder="Buscar" [(ngModel)]="searchText" name="searchText" (input)="filtrar()" />
      </div>

      <select mdbSelect class="form-select w-auto">
        <option>Nome</option>
      </select>

      <select mdbSelect class="form-select w-auto">
        <option>Estoque</option>
      </select>

      <select mdbSelect class="form-select w-auto">
        <option>Pre√ßo</option>
      </select>
    </div>

    <!-- Tabela -->
    <div class="card rounded-4 shadow-sm">
      <div class="card-body">
        <table mdbTable class="table table-hover align-middle mb-0">
          <thead>
            <tr>
              <th></th>
              <th>Nome</th>
              <th>Categoria</th>
              <th>Estoque</th>
              <th>Pre√ßo</th>
              <th>A√ß√µes</th>
            </tr>
          </thead>
          <tbody>
  <tr *ngFor="let produto of produtos">
  <td><input class="form-check-input" type="checkbox" /></td>

  <!-- Nome -->
  <td>
    <ng-container *ngIf="produtoEditando?.id === produto.id; else nomeView">
      <input 
        type="text"
        [(ngModel)]="produtoEditando!.nome"
        [ngModelOptions]="{standalone: true}"
        class="form-control form-control-sm"
        placeholder="Nome"
      />
    </ng-container>
    <ng-template #nomeView>{{ produto.nome || 'Nome do produto' }}</ng-template>
  </td>

  <!-- Categoria -->
  <td>
    <ng-container *ngIf="produtoEditando?.id === produto.id; else categoriaView">
      <input 
        type="number"
        [(ngModel)]="produtoEditando!.categoria.id"
        [ngModelOptions]="{standalone: true}"
        class="form-control form-control-sm"
        placeholder="ID da categoria"
      />
    </ng-container>
    <ng-template #categoriaView>{{ produto.categoria?.nome || 'Categoria' }}</ng-template>
  </td>

  <!-- Estoque -->
  <td>
    <ng-container *ngIf="produtoEditando?.id === produto.id; else quantidadeView">
      <input 
        type="number"
        [(ngModel)]="produtoEditando!.quantidade"
        [ngModelOptions]="{standalone: true}"
        class="form-control form-control-sm"
        placeholder="Qtd"
      />
    </ng-container>
    <ng-template #quantidadeView>{{ produto.quantidade ?? '-' }}</ng-template>
  </td>

  <!-- Pre√ßo -->
  <td>
    <ng-container *ngIf="produtoEditando?.id === produto.id; else precoView">
      <input 
        type="number" 
        step="0.01"
        [(ngModel)]="produtoEditando!.preco"
        [ngModelOptions]="{standalone: true}"
        class="form-control form-control-sm"
        placeholder="Pre√ßo"
      />
    </ng-container>
    <ng-template #precoView>{{ produto.preco != null ? (produto.preco | currency: 'BRL') : '-' }}</ng-template>
  </td>

  <!-- A√ß√µes -->
  <td>
    <ng-container *ngIf="produtoEditando?.id === produto.id; else botoesNormais">
      <button mdbBtn size="sm" color="success" (click)="salvarEdicao()">üíæ</button>
      <button mdbBtn size="sm" color="secondary" (click)="cancelarEdicao()">‚úñ</button>
    </ng-container>
    <ng-template #botoesNormais>
      <button mdbBtn size="sm" color="link" (click)="editar(produto)">‚úèÔ∏è</button>
      <button mdbBtn size="sm" color="danger" (click)="remover(produto)">üóëÔ∏è</button>
    </ng-template>
  </td>
</tr>


</tbody>

        </table>
      </div>
    </div>
  </main>
</div>
