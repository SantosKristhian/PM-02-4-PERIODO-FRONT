<div class="d-flex min-vh-100 bg-light">
  <!-- Sidebar -->

  <main class="flex-grow-1 p-4">
    <!-- Cabe√ßalho -->
  
    <div class="d-flex justify-content-between align-items-center mb-4">
  <h1 class="h4 fw-bold">Sistema de Estoque</h1>

  <div class="d-flex gap-2">
    <!-- Bot√£o de adicionar produto -->
    <button mdbBtn color="dark" rounded="true" (click)="mostrarForm = !mostrarForm">
      Adicionar novo item
    </button>

    <!-- Bot√£o de gerenciar categorias -->
    <button mdbBtn color="secondary" rounded="true" (click)="irParaCategorias()">
      Gerenciar Categorias
    </button>
  </div>
</div>

      <!-- Formul√°rio de cria√ß√£o -->
<div *ngIf="mostrarForm" class="card p-3 mb-4 shadow-sm rounded-4">
  <h5 class="mb-3">Novo Produto</h5>
  <form (ngSubmit)="criarProduto()">
    <div class="row g-2">
      <!-- Nome -->
      <div class="col-md-4">
        <label for="nomeProduto" class="form-label">Nome do Produto</label>
        <input 
          id="nomeProduto"
          type="text" 
          class="form-control" 
          [(ngModel)]="novoProduto.nome" 
          name="nome" 
          required 
        />
      </div>

      <!-- Quantidade -->
      <div class="col-md-2">
        <label for="quantidadeProduto" class="form-label">Quantidade</label>
        <input 
          id="quantidadeProduto"
          type="number" 
          class="form-control" 
          [(ngModel)]="novoProduto.quantidade" 
          name="quantidade" 
          required 
        />
      </div>

      <!-- Pre√ßo -->
      <div class="col-md-2">
        <label for="precoProduto" class="form-label">Pre√ßo (R$)</label>
        <input 
          id="precoProduto"
          type="number" 
          step="0.01" 
          class="form-control" 
          [(ngModel)]="novoProduto.preco" 
          name="preco" 
          required 
        />
      </div>

      <!-- Categoria -->
     <div class="col-md-3">
  <label for="categoriaProduto" class="form-label">Categoria</label>
  <select 
    id="categoriaProduto" 
    class="form-select" 
    [(ngModel)]="novoProduto.categoria.id" 
    name="categoriaId" 
    required>
    <option [ngValue]="null" disabled selected>Selecione uma categoria</option>
    <option *ngFor="let cat of categorias" [ngValue]="cat.id">
      {{ cat.nome }}
    </option>
  </select>
</div>


      <!-- Bot√µes -->
      <div class="col-md-1 d-flex gap-2 align-items-end">
        <button mdbBtn color="success" type="submit">‚úî</button>
        <button mdbBtn color="secondary" type="button" (click)="mostrarForm = false">‚úñ</button>
      </div>
    </div>
  </form>
</div>



    <!-- Barra de busca e filtros -->
    <div class="d-flex gap-2 mb-3 flex-wrap">
      <div class="form-outline flex-grow-1">
        <input type="text" id="searchInput" class="form-control" placeholder="Buscar" [(ngModel)]="searchText" name="searchText" (input)="filtrar()" />
      </div>

      
    </div>

    <!-- Tabela -->
    <div class="card rounded-4 shadow-sm">
      <div class="card-body">
        <table mdbTable class="table table-hover align-middle mb-0">
          <thead>
            <tr>
              <th></th>
              <th>Nome</th>
              <th>Categoria</th>
              <th>Estoque</th>
              <th>Pre√ßo</th>
              <th>A√ß√µes</th>
            </tr>
          </thead>
          <tbody>
  <tr *ngFor="let produto of produtos">
  <td><input class="form-check-input" type="checkbox" /></td>

  <!-- Nome -->
  <td>
    <ng-container *ngIf="produtoEditando?.id === produto.id; else nomeView">
      <input 
        type="text"
        [(ngModel)]="produtoEditando!.nome"
        [ngModelOptions]="{standalone: true}"
        class="form-control form-control-sm"
        placeholder="Nome"
      />
    </ng-container>
    <ng-template #nomeView>{{ produto.nome || 'Nome do produto' }}</ng-template>
  </td>

  <!-- Categoria -->
  <td>
    <ng-container *ngIf="produtoEditando?.id === produto.id; else categoriaView">
      <input 
        type="number"
        [(ngModel)]="produtoEditando!.categoria.id"
        [ngModelOptions]="{standalone: true}"
        class="form-control form-control-sm"
        placeholder="ID da categoria"
      />
    </ng-container>
    <ng-template #categoriaView>{{ produto.categoria?.nome || 'Categoria' }}</ng-template>
  </td>

  <!-- Estoque -->
  <td>
    <ng-container *ngIf="produtoEditando?.id === produto.id; else quantidadeView">
      <input 
        type="number"
        [(ngModel)]="produtoEditando!.quantidade"
        [ngModelOptions]="{standalone: true}"
        class="form-control form-control-sm"
        placeholder="Qtd"
      />
    </ng-container>
    <ng-template #quantidadeView>{{ produto.quantidade ?? '-' }}</ng-template>
  </td>

  <!-- Pre√ßo -->
  <td>
    <ng-container *ngIf="produtoEditando?.id === produto.id; else precoView">
      <input 
        type="number" 
        step="0.01"
        [(ngModel)]="produtoEditando!.preco"
        [ngModelOptions]="{standalone: true}"
        class="form-control form-control-sm"
        placeholder="Pre√ßo"
      />
    </ng-container>
    <ng-template #precoView>{{ produto.preco != null ? (produto.preco | currency: 'BRL') : '-' }}</ng-template>
  </td>

  <!-- A√ß√µes -->
  <td>
    <ng-container *ngIf="produtoEditando?.id === produto.id; else botoesNormais">
      <button mdbBtn size="sm" color="success" (click)="salvarEdicao()">üíæ</button>
      <button mdbBtn size="sm" color="secondary" (click)="cancelarEdicao()">‚úñ</button>
    </ng-container>
    <ng-template #botoesNormais>
      <button mdbBtn size="sm" color="link" (click)="editar(produto)">‚úèÔ∏è</button>
      <button mdbBtn size="sm" color="danger" (click)="remover(produto)">üóëÔ∏è</button>
    </ng-template>
  </td>
</tr>


</tbody>

        </table>
      </div>
    </div>
  </main>
</div>
