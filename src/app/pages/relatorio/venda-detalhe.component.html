<div class="container mt-4">
  <div *ngIf="loading">Carregando...</div>
  <div *ngIf="error" class="text-danger">{{ error }}</div>

  <div *ngIf="venda">
    <h3>Venda #{{ venda.id }}</h3>
    <p>Data: {{ venda.data | date:'short' }}</p>
    <p>Comprador: {{ venda.comprador?.nome || '-' }}</p>
    <p>Usuário: {{ venda.usuario?.nome || '-' }}</p>
    <p>Valor Total: {{ venda.valortotal | currency:'BRL' }}</p>
    <p *ngIf="venda.ativo === false">
  Itens Devolvidos:
  <span *ngIf="venda.itensDevolvidos === true" class="badge bg-success">Sim</span>
  <span *ngIf="venda.itensDevolvidos === false" class="badge bg-danger">Não</span>
  <span *ngIf="venda.itensDevolvidos == null">-</span>
</p>

    <h4>Itens</h4>
    <table class="table table-sm">
      <thead>
        <tr>
          <th>Produto</th>
          <th>Quantidade</th>
          <th>Preço</th>
          <th>Subtotal</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of venda.itens">
          <td>{{ item.produto?.nome || item.produto?.id || '-' }}</td>
          <td>{{ item.quantidadeVendida ?? item.quantidade ?? '-' }}</td>
          <td>{{ (item.precoVendido ?? item.precoUnitario) | currency:'BRL' }}</td>
          <td>{{ ((item.precoVendido ?? item.precoUnitario) * (item.quantidadeVendida ?? item.quantidade ?? 0)) | currency:'BRL' }}</td>
        </tr>
      </tbody>
    </table>

    <div class="mt-3">
        <p><strong>Forma de pagamento: </strong> {{ getMetodoLabel(venda.metodoPagamento) }}</p>
        <p>Valor Pago: {{ venda.valorPago | currency:'BRL' }}</p>
        <p>Troco: {{ venda.troco | currency:'BRL' }}</p>
    </div>

    <button class="btn btn-secondary" (click)="voltar()">Voltar</button>
  </div>
</div>
